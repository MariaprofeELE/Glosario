<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Glosario: la casa</title>
  <script>
    const endpoint = "https://script.google.com/macros/s/AKfycbxjJbt5B3gvEDFyuVxS2DKP-d4gbjyU1QOcFnGnurEc2P3i7YO9Ku_Tz8MayFGK9ZyXqw/exec";
  </script>
  https://cdn.tailwindcss.com
</head>
<body class="bg-gray-100 min-h-screen">
  <div class="container mx-auto px-4 py-6 max-w-6xl">
    <!-- Header -->
    <div class="text-center mb-6">
      <h1 class="text-3xl font-bold text-blue-800 mb-2">Glosario de la casa</h1>
      <p class="text-gray-600">AÃ±ade imÃ¡genes y palabras para crear un glosario colaborativo sobre la casa</p>
    </div>

    <!-- Formulario -->
    <div class="bg-white rounded-lg shadow-md p-4 mb-6">
      <h2 class="text-xl font-semibold text-blue-700 mb-3">AÃ±adir Nueva Palabra</h2>
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4">
        <!-- Imagen -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Imagen:</label>
          <button type="button" class="w-full bg-blue-500 hover:bg-blue-600 text-white px-3 py-2 rounded text-sm transition" onclick="document.getElementById('photoInput').click()">ðŸ“· Seleccionar</button>
          <input type="file" id="photoInput" accept="image/*" class="hidden" onchange="handlePhotoUpload('photoInput', 'photoPreview')" />
          <div id="photoPreview" class="mt-1 text-xs text-gray-500">Sin imagen</div>
        </div>

        <!-- CategorÃ­a -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">CategorÃ­a:</label>
          <select id="category" class="w-full px-3 py-2 border rounded text-sm focus:outline-none focus:ring-2 focus:ring-blue-500">
            <option value="">Seleccionar...</option>
            <option value="habitaciÃ³n">HabitaciÃ³n</option>
            <option value="objeto/mueble">Objeto/Mueble</option>
            <option value="caracterÃ­stica">CaracterÃ­stica</option>
          </select>
        </div>

        <!-- Palabra -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Palabra:</label>
          <input type="text" id="objectName" class="w-full px-3 py-2 border rounded text-sm focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Nombre de la palabra" />
        </div>

        <!-- Estudiante -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Tu nombre:</label>
          <input type="text" id="studentName" class="w-full px-3 py-2 border rounded text-sm focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Tu nombre" />
        </div>
      </div>
      <button id="addObject" class="bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-4 rounded transition w-full md:w-auto">âž• AÃ±adir al Glosario</button>
    </div>

    <!-- Mensaje cuando no hay objetos -->
    <div id="noObjects" class="text-center text-gray-500 py-8 bg-white rounded-lg shadow-md">
      AÃºn no hay palabras. Â¡AÃ±ade la primera!
    </div>

    <!-- Grid de objetos -->
    <div id="objectsGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4"></div>
  </div>

  <script>
    const objects = [];
    let photoData = null;
    let currentFilter = 'todos';

    function handlePhotoUpload(inputId, previewId) {
      const input = document.getElementById(inputId);
      const preview = document.getElementById(previewId);
      if (input.files && input.files[0]) {
        const reader = new FileReader();
        reader.onload = function (e) {
          photoData = e.target.result;
          preview.innerHTML = `<span class="text-green-600 font-medium">âœ“ ${input.files[0].name}</span>`;
        };
        reader.readAsDataURL(input.files[0]);
      }
    }

    document.getElementById('addObject').addEventListener('click', function () {
      const category = document.getElementById('category').value;
      const objectName = document.getElementById('objectName').value.trim();
      const studentName = document.getElementById('studentName').value.trim();

      if (!photoData || !category || !objectName || !studentName) {
        alert('Por favor, completa todos los campos');
        return;
      }

      const newObject = {
        photo: photoData,
        category,
        objectName,
        description: "",
        studentName,
        date: new Date().toLocaleDateString()
      };

      objects.push(newObject);
      updateObjectsGrid();
      sendToServer(newObject);

      // Limpiar formulario
      photoData = null;
      document.getElementById('photoPreview').innerHTML = 'Sin imagen';
      document.getElementById('category').value = '';
      document.getElementById('objectName').value = '';
      document.getElementById('studentName').value = '';
    });

    function updateObjectsGrid() {
      const grid = document.getElementById('objectsGrid');
      const noObjects = document.getElementById('noObjects');
      grid.innerHTML = '';

      if (objects.length === 0) {
        noObjects.classList.remove('hidden');
        return;
      }

      noObjects.classList.add('hidden');

      objects.forEach((object) => {
        const card = document.createElement('div');
        card.className = 'bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-shadow';
        card.innerHTML = `
          <div class="h-32 bg-gray-100 flex items-center justify-center overflow-hidden">
            <img src="${object.photo}" class="max-w-full max-h-full object-contain" alt="${object.objectName}" />
          </div>
          <div class="p-3">
            <div class="flex justify-between items-start mb-2">
              <h3 class="font-bold text-gray-800 text-sm">${object.objectName}</h3>
              <span class="px-2 py-1 text-xs rounded bg-blue-100 border border-blue-300 text-blue-800">${object.category}</span>
            </div>
            <p class="text-xs text-gray-600 mb-2">Por: ${object.studentName}</p>
            <p class="text-xs text-gray-400 italic mb-2">Sin frase aÃºn</p>
          </div>
        `;
        grid.appendChild(card);
      });
    }

    async function sendToServer(data) {
      try {
        await fetch(endpoint, {
          method: "POST",
          mode: "no-cors",
          headers: {
            "Content-Type": "application/json"
          },
          body: JSON.stringify(data)
        });
      } catch (error) {
        console.error("Error al enviar al servidor:", error);
      }
    }
  </script>
</body>
</html>
